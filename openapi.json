{"openapi":"3.1.0","info":{"title":"GraceHub Mini App API","version":"0.1.0"},"paths":{"/manage/health":{"get":{"tags":["manage"],"summary":"Manage Health","operationId":"manage_health_manage_health_get","parameters":[{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/instances/{instance_id}/billing/create_invoice":{"post":{"summary":"Create Billing Invoice","operationId":"create_billing_invoice_api_instances__instance_id__billing_create_invoice_post","parameters":[{"name":"instance_id","in":"path","required":true,"schema":{"type":"string","title":"Instance Id"}},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateInvoiceRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateInvoiceResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/invoices/stripe/{invoice_id}/status":{"get":{"summary":"Get Stripe Invoice Status","operationId":"get_stripe_invoice_status_api_invoices_stripe__invoice_id__status_get","parameters":[{"name":"invoice_id","in":"path","required":true,"schema":{"type":"integer","title":"Invoice Id"}},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/StripeInvoiceStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/offer/settings":{"get":{"summary":"Get Offer Settings","operationId":"get_offer_settings_api_offer_settings_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OfferSettingsOut"}}}}}}},"/api/offer/status":{"get":{"summary":"Get Offer Status","operationId":"get_offer_status_api_offer_status_get","parameters":[{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OfferStatusOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/offer/decision":{"post":{"summary":"Post Offer Decision","operationId":"post_offer_decision_api_offer_decision_post","parameters":[{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/OfferDecisionIn"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/invoices/stripe/{invoice_id}/cancel":{"post":{"summary":"Cancel Stripe Invoice","operationId":"cancel_stripe_invoice_api_invoices_stripe__invoice_id__cancel_post","parameters":[{"name":"invoice_id","in":"path","required":true,"schema":{"type":"integer","title":"Invoice Id"}},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/StripeInvoiceCancelResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/webhook/stripe":{"post":{"summary":"Stripe Webhook","operationId":"stripe_webhook_api_webhook_stripe_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/platform/single-tenant":{"get":{"summary":"Get Single Tenant Config Endpoint","operationId":"get_single_tenant_config_endpoint_api_platform_single_tenant_get","parameters":[{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SingleTenantConfig"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"summary":"Set Single Tenant Config Endpoint","operationId":"set_single_tenant_config_endpoint_api_platform_single_tenant_post","parameters":[{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SingleTenantConfig"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SingleTenantConfig"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/platform/superadmins":{"get":{"summary":"Get Platform Superadmins","operationId":"get_platform_superadmins_api_platform_superadmins_get","parameters":[{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuperadminsResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"summary":"Set Platform Superadmins","operationId":"set_platform_superadmins_api_platform_superadmins_post","parameters":[{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuperadminsUpsert"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuperadminsResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/telegram":{"post":{"summary":"Auth Telegram","operationId":"auth_telegram_api_auth_telegram_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TelegramAuthRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/billing/ton/cancel":{"post":{"summary":"Cancel Ton Invoice","operationId":"cancel_ton_invoice_api_billing_ton_cancel_post","parameters":[{"name":"invoice_id","in":"query","required":true,"schema":{"type":"integer","title":"Invoice Id"}},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TonInvoiceCancelResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/saas/plans":{"get":{"summary":"Get Saas Plans","description":"Возвращает список активных тарифных планов с ценой в Stars\nи привязанным billing_product (если есть).","operationId":"get_saas_plans_api_saas_plans_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/SaasPlanOut"},"type":"array","title":"Response Get Saas Plans Api Saas Plans Get"}}}}}}},"/api/billing/yookassa/status":{"get":{"summary":"Yookassa Invoice Status","operationId":"yookassa_invoice_status_api_billing_yookassa_status_get","parameters":[{"name":"invoice_id","in":"query","required":true,"schema":{"type":"integer","title":"Invoice Id"}},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/YooKassaStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/billing/yookassa/webhook":{"post":{"summary":"Yookassa Webhook","operationId":"yookassa_webhook_api_billing_yookassa_webhook_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/platform/settings":{"get":{"summary":"Get Platform Settings","operationId":"get_platform_settings_api_platform_settings_get","parameters":[{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/platform/settings/{key}":{"post":{"summary":"Set Platform Settings","operationId":"set_platform_settings_api_platform_settings__key__post","parameters":[{"name":"key","in":"path","required":true,"schema":{"type":"string","title":"Key"}},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlatformSettingUpsert"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/instances/{instance_id}/billing":{"get":{"summary":"Get Instance Billing Endpoint","description":"Возвращает информацию о тарифе и лимитах для инстанса.\nДоступен всем, у кого есть доступ к инстансу (owner/operator/viewer).","operationId":"get_instance_billing_endpoint_api_instances__instance_id__billing_get","parameters":[{"name":"instance_id","in":"path","required":true,"schema":{"type":"string","title":"Instance Id"}},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BillingInfo"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/billing/ton/status":{"get":{"summary":"Ton Invoice Status","operationId":"ton_invoice_status_api_billing_ton_status_get","parameters":[{"name":"invoice_id","in":"query","required":true,"schema":{"type":"integer","title":"Invoice Id"}},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TonInvoiceStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/resolve_instance":{"post":{"summary":"Resolve Instance","operationId":"resolve_instance_api_resolve_instance_post","parameters":[{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResolveInstanceRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResolveInstanceResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/me":{"get":{"summary":"Get Me","operationId":"get_me_api_me_get","parameters":[{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/instances":{"get":{"summary":"List Instances","operationId":"list_instances_api_instances_get","parameters":[{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/InstanceInfo"},"title":"Response List Instances Api Instances Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"summary":"Create Instance","description":"Создать новый инстанс по токену бота через MasterBot:\n- MasterBot проверяет токен, создаёт запись в БД, шифрует токен, запускает воркер.","operationId":"create_instance_api_instances_post","parameters":[{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateInstanceRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateInstanceResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/instances/{instance_id}/stats":{"get":{"summary":"Get Instance Stats","operationId":"get_instance_stats_api_instances__instance_id__stats_get","parameters":[{"name":"instance_id","in":"path","required":true,"schema":{"type":"string","title":"Instance Id"}},{"name":"days","in":"query","required":false,"schema":{"type":"integer","maximum":365,"minimum":1,"default":30,"title":"Days"}},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InstanceStats"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/instances/{instance_id}":{"delete":{"summary":"Delete Instance Endpoint","description":"Удаление инстанса из мини-аппы (аналог /remove_bot в мастере).\nДоступ только у владельца / интегратора.","operationId":"delete_instance_endpoint_api_instances__instance_id__delete","parameters":[{"name":"instance_id","in":"path","required":true,"schema":{"type":"string","title":"Instance Id"}},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/instances/{instance_id}/settings":{"get":{"summary":"Get Instance Settings Endpoint","operationId":"get_instance_settings_endpoint_api_instances__instance_id__settings_get","parameters":[{"name":"instance_id","in":"path","required":true,"schema":{"type":"string","title":"Instance Id"}},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InstanceSettings"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"summary":"Update Instance Settings Endpoint","operationId":"update_instance_settings_endpoint_api_instances__instance_id__settings_post","parameters":[{"name":"instance_id","in":"path","required":true,"schema":{"type":"string","title":"Instance Id"}},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateInstanceSettings"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InstanceSettings"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/instances/{instance_id}/tickets":{"get":{"summary":"List Tickets Endpoint","operationId":"list_tickets_endpoint_api_instances__instance_id__tickets_get","parameters":[{"name":"instance_id","in":"path","required":true,"schema":{"type":"string","title":"Instance Id"}},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status"}},{"name":"search","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Search"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"default":20,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","minimum":0,"default":0,"title":"Offset"}},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TicketsListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/instances/{instance_id}/tickets/{ticket_id}/status":{"post":{"summary":"Update Ticket Status Endpoint","operationId":"update_ticket_status_endpoint_api_instances__instance_id__tickets__ticket_id__status_post","parameters":[{"name":"instance_id","in":"path","required":true,"schema":{"type":"string","title":"Instance Id"}},{"name":"ticket_id","in":"path","required":true,"schema":{"type":"integer","title":"Ticket Id"}},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateTicketStatusRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/instances/{instance_id}/operators":{"get":{"summary":"Get Operators","operationId":"get_operators_api_instances__instance_id__operators_get","parameters":[{"name":"instance_id","in":"path","required":true,"schema":{"type":"string","title":"Instance Id"}},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/InstanceMember"},"title":"Response Get Operators Api Instances  Instance Id  Operators Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"summary":"Add Operator","operationId":"add_operator_api_instances__instance_id__operators_post","parameters":[{"name":"instance_id","in":"path","required":true,"schema":{"type":"string","title":"Instance Id"}},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AddOperatorRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/instances/{instance_id}/operators/{user_id}":{"delete":{"summary":"Remove Operator","operationId":"remove_operator_api_instances__instance_id__operators__user_id__delete","parameters":[{"name":"instance_id","in":"path","required":true,"schema":{"type":"string","title":"Instance Id"}},{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/health":{"get":{"summary":"Health","operationId":"health_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"AddOperatorRequest":{"properties":{"user_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"User Id"},"username":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Username"},"role":{"type":"string","title":"Role","default":"operator"}},"type":"object","title":"AddOperatorRequest"},"AuthResponse":{"properties":{"token":{"type":"string","title":"Token"},"user":{"$ref":"#/components/schemas/UserResponse"},"default_instance_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Default Instance Id"}},"type":"object","required":["token","user"],"title":"AuthResponse"},"AutoReplyConfig":{"properties":{"greeting":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Greeting"},"default_answer":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Default Answer"}},"type":"object","title":"AutoReplyConfig"},"BillingInfo":{"properties":{"instance_id":{"type":"string","title":"Instance Id"},"plan_code":{"type":"string","title":"Plan Code"},"plan_name":{"type":"string","title":"Plan Name"},"price_stars":{"type":"integer","title":"Price Stars"},"tickets_used":{"type":"integer","title":"Tickets Used"},"tickets_limit":{"type":"integer","title":"Tickets Limit"},"over_limit":{"type":"boolean","title":"Over Limit"},"period_start":{"type":"string","title":"Period Start"},"period_end":{"type":"string","title":"Period End"},"days_left":{"type":"integer","title":"Days Left"},"unlimited":{"type":"boolean","title":"Unlimited"}},"type":"object","required":["instance_id","plan_code","plan_name","price_stars","tickets_used","tickets_limit","over_limit","period_start","period_end","days_left","unlimited"],"title":"BillingInfo"},"BrandingConfig":{"properties":{"bot_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Bot Name"},"status_emoji_scheme":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Status Emoji Scheme"}},"type":"object","title":"BrandingConfig"},"CreateInstanceRequest":{"properties":{"token":{"type":"string","title":"Token"}},"type":"object","required":["token"],"title":"CreateInstanceRequest","description":"Создание нового инстанса по токену бота (аналог /add_bot)."},"CreateInstanceResponse":{"properties":{"instanceid":{"type":"string","title":"Instanceid"},"botusername":{"type":"string","title":"Botusername"},"botname":{"type":"string","title":"Botname"},"role":{"type":"string","title":"Role","default":"owner"}},"type":"object","required":["instanceid","botusername","botname"],"title":"CreateInstanceResponse"},"CreateInvoiceRequest":{"properties":{"plan_code":{"type":"string","title":"Plan Code","description":"Код тарифа (lite/pro/enterprise/demo)"},"periods":{"type":"integer","maximum":24.0,"minimum":1.0,"title":"Periods","description":"Количество периодов (1,3,12)"},"payment_method":{"allOf":[{"$ref":"#/components/schemas/PaymentMethod"}],"description":"Метод оплаты","default":"telegram_stars"}},"type":"object","required":["plan_code","periods"],"title":"CreateInvoiceRequest"},"CreateInvoiceResponse":{"properties":{"invoice_id":{"type":"integer","title":"Invoice Id","description":"Unique identifier for the invoice"},"invoice_link":{"type":"string","title":"Invoice Link","description":"URL to the invoice or payment page"},"amount_minor_units":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Amount Minor Units","description":"Amount in minor units (e.g., nanoton for TON)"},"amount_ton":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Amount Ton","description":"Human-readable amount in TON"},"session_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Session Id","description":"Stripe Checkout session ID"},"amount_cents":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Amount Cents","description":"Amount in cents (minor units for Stripe currencies like USD)"},"currency":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Currency","description":"Currency code (e.g., 'TON', 'XTR', 'USD')"}},"type":"object","required":["invoice_id","invoice_link"],"title":"CreateInvoiceResponse"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"InstanceInfo":{"properties":{"instance_id":{"type":"string","title":"Instance Id"},"bot_username":{"type":"string","title":"Bot Username"},"bot_name":{"type":"string","title":"Bot Name"},"role":{"type":"string","title":"Role"},"status":{"type":"string","title":"Status","default":"running"},"created_at":{"type":"string","title":"Created At"},"openchat_username":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Openchat Username"},"general_panel_chat_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"General Panel Chat Id"}},"type":"object","required":["instance_id","bot_username","bot_name","role","created_at"],"title":"InstanceInfo"},"InstanceMember":{"properties":{"user_id":{"type":"integer","title":"User Id"},"username":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Username"},"role":{"type":"string","title":"Role"},"created_at":{"type":"string","title":"Created At"}},"type":"object","required":["user_id","username","role","created_at"],"title":"InstanceMember"},"InstanceSettings":{"properties":{"openchat_enabled":{"type":"boolean","title":"Openchat Enabled","default":false},"autoclose_hours":{"type":"integer","title":"Autoclose Hours","default":12},"general_panel_chat_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"General Panel Chat Id"},"auto_reply":{"$ref":"#/components/schemas/AutoReplyConfig"},"branding":{"$ref":"#/components/schemas/BrandingConfig"},"privacy_mode_enabled":{"type":"boolean","title":"Privacy Mode Enabled","default":false},"language":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Language"},"openchat":{"anyOf":[{"$ref":"#/components/schemas/OpenChatConfig"},{"type":"null"}]}},"type":"object","required":["auto_reply","branding"],"title":"InstanceSettings"},"InstanceStats":{"properties":{"instance_id":{"type":"string","title":"Instance Id"},"period":{"additionalProperties":{"type":"string"},"type":"object","title":"Period"},"tickets_by_status":{"$ref":"#/components/schemas/TicketStats"},"avg_first_response_sec":{"type":"integer","title":"Avg First Response Sec","default":0},"unique_users":{"type":"integer","title":"Unique Users","default":0},"usage":{"$ref":"#/components/schemas/UsageStats"}},"type":"object","required":["instance_id","period","tickets_by_status","usage"],"title":"InstanceStats"},"OfferDecisionIn":{"properties":{"accepted":{"type":"boolean","title":"Accepted"}},"type":"object","required":["accepted"],"title":"OfferDecisionIn"},"OfferSettingsOut":{"properties":{"enabled":{"type":"boolean","title":"Enabled","default":false},"url":{"type":"string","title":"Url","default":""}},"type":"object","title":"OfferSettingsOut"},"OfferStatusOut":{"properties":{"enabled":{"type":"boolean","title":"Enabled","default":false},"url":{"type":"string","title":"Url","default":""},"accepted":{"type":"boolean","title":"Accepted","default":true},"acceptedAt":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Acceptedat"}},"type":"object","title":"OfferStatusOut"},"OpenChatConfig":{"properties":{"enabled":{"type":"boolean","title":"Enabled","default":false},"openchat_username":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Openchat Username"},"general_panel_chat_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"General Panel Chat Id"}},"type":"object","title":"OpenChatConfig"},"PaymentMethod":{"type":"string","enum":["telegram_stars","ton","yookassa","stripe"],"title":"PaymentMethod"},"PlatformSettingUpsert":{"properties":{"value":{"type":"object","title":"Value"}},"type":"object","required":["value"],"title":"PlatformSettingUpsert"},"ResolveInstanceRequest":{"properties":{"instance_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Instance Id"},"admin_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Admin Id"}},"type":"object","title":"ResolveInstanceRequest","description":"Запрос на определение инстанса при старте мини‑аппы.\nЛюбое из полей может быть None:\n- instance_id: явное указание инстанса\n- admin_id: Telegram user id администратора, к которому привязан инстанс"},"ResolveInstanceResponse":{"properties":{"instance_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Instance Id"},"bot_username":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Bot Username"},"bot_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Bot Name"},"role":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Role"},"created_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Created At"},"openchat_username":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Openchat Username"},"general_panel_chat_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"General Panel Chat Id"},"link_forbidden":{"type":"boolean","title":"Link Forbidden","default":false}},"type":"object","title":"ResolveInstanceResponse","description":"Ответ для мини‑аппы при старте.\nЕсли instance_id указан — панель открывается сразу для этого инстанса.\nЕсли instance_id = None — фронт должен запросить список инстансов /api/instances."},"SaasPlanOut":{"properties":{"planCode":{"type":"string","title":"Plancode"},"planName":{"type":"string","title":"Planname"},"periodDays":{"type":"integer","title":"Perioddays"},"ticketsLimit":{"type":"integer","title":"Ticketslimit"},"priceStars":{"type":"integer","title":"Pricestars"},"productCode":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Productcode"}},"type":"object","required":["planCode","planName","periodDays","ticketsLimit","priceStars","productCode"],"title":"SaasPlanOut"},"SingleTenantConfig":{"properties":{"enabled":{"type":"boolean","title":"Enabled","default":false},"allowed_user_ids":{"items":{"type":"integer"},"type":"array","title":"Allowed User Ids"}},"type":"object","title":"SingleTenantConfig"},"StripeInvoiceCancelResponse":{"properties":{"invoice_id":{"type":"integer","title":"Invoice Id"},"status":{"type":"string","title":"Status"}},"type":"object","required":["invoice_id","status"],"title":"StripeInvoiceCancelResponse"},"StripeInvoiceStatusResponse":{"properties":{"invoice_id":{"type":"integer","title":"Invoice Id"},"status":{"type":"string","title":"Status"},"session_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Session Id"},"payment_intent_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Payment Intent Id"},"period_applied":{"type":"boolean","title":"Period Applied","default":false}},"type":"object","required":["invoice_id","status"],"title":"StripeInvoiceStatusResponse"},"SuperadminsResponse":{"properties":{"ids":{"items":{"type":"integer"},"type":"array","title":"Ids"}},"type":"object","title":"SuperadminsResponse"},"SuperadminsUpsert":{"properties":{"ids":{"items":{"type":"integer"},"type":"array","title":"Ids"}},"type":"object","title":"SuperadminsUpsert"},"TelegramAuthRequest":{"properties":{"initData":{"type":"string","title":"Initdata"},"start_param":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Start Param"}},"type":"object","required":["initData"],"title":"TelegramAuthRequest"},"TicketItem":{"properties":{"ticket_id":{"type":"integer","title":"Ticket Id"},"user_id":{"type":"integer","title":"User Id"},"username":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Username"},"status":{"type":"string","title":"Status"},"status_emoji":{"type":"string","title":"Status Emoji"},"created_at":{"type":"string","title":"Created At"},"last_user_msg_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Last User Msg At"},"last_admin_reply_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Last Admin Reply At"},"openchat_topic_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Openchat Topic Id"}},"type":"object","required":["ticket_id","user_id","username","status","status_emoji","created_at","last_user_msg_at","last_admin_reply_at","openchat_topic_id"],"title":"TicketItem"},"TicketStats":{"properties":{"new":{"type":"integer","title":"New","default":0},"inprogress":{"type":"integer","title":"Inprogress","default":0},"answered":{"type":"integer","title":"Answered","default":0},"closed":{"type":"integer","title":"Closed","default":0},"spam":{"type":"integer","title":"Spam","default":0}},"type":"object","title":"TicketStats"},"TicketsListResponse":{"properties":{"items":{"items":{"$ref":"#/components/schemas/TicketItem"},"type":"array","title":"Items"},"total":{"type":"integer","title":"Total"}},"type":"object","required":["items","total"],"title":"TicketsListResponse"},"TonInvoiceCancelResponse":{"properties":{"invoice_id":{"type":"integer","title":"Invoice Id"},"status":{"type":"string","title":"Status"}},"type":"object","required":["invoice_id","status"],"title":"TonInvoiceCancelResponse"},"TonInvoiceStatusResponse":{"properties":{"invoice_id":{"type":"integer","title":"Invoice Id"},"status":{"type":"string","title":"Status"},"tx_hash":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Tx Hash"},"period_applied":{"type":"boolean","title":"Period Applied","default":false}},"type":"object","required":["invoice_id","status"],"title":"TonInvoiceStatusResponse"},"UpdateInstanceSettings":{"properties":{"autoclose_hours":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Autoclose Hours"},"auto_reply":{"anyOf":[{"$ref":"#/components/schemas/AutoReplyConfig"},{"type":"null"}]},"branding":{"anyOf":[{"$ref":"#/components/schemas/BrandingConfig"},{"type":"null"}]},"openchat_enabled":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Openchat Enabled"},"privacy_mode_enabled":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Privacy Mode Enabled"},"language":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Language"}},"type":"object","title":"UpdateInstanceSettings"},"UpdateTicketStatusRequest":{"properties":{"status":{"type":"string","title":"Status","description":"new, inprogress, answered, closed, spam"}},"type":"object","required":["status"],"title":"UpdateTicketStatusRequest"},"UsageStats":{"properties":{"messages":{"type":"integer","title":"Messages","default":0},"api_calls":{"type":"integer","title":"Api Calls","default":0}},"type":"object","title":"UsageStats"},"UserResponse":{"properties":{"user_id":{"type":"integer","title":"User Id"},"username":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Username"},"first_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"First Name"},"last_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Last Name"},"language":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Language"},"roles":{"items":{"type":"string"},"type":"array","title":"Roles"},"instances":{"items":{"type":"object"},"type":"array","title":"Instances"}},"type":"object","required":["user_id","username","first_name","last_name","language"],"title":"UserResponse"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"YooKassaStatusResponse":{"properties":{"invoice_id":{"type":"integer","title":"Invoice Id"},"status":{"type":"string","title":"Status"},"payment_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Payment Id"},"period_applied":{"type":"boolean","title":"Period Applied","default":false}},"type":"object","required":["invoice_id","status"],"title":"YooKassaStatusResponse"}}}}