{% extends "base.html" %}

{% block extrahead %}
  {{ super() }}
  <script>
    (function () {
      try {
        // 1) Читаем тему с главного сайта и синхронизируем палитру Material
        var stored = localStorage.getItem('theme');  // 'light' / 'dark'
        if (stored) {
          var scheme = stored === 'dark' ? 'slate' : 'default';
          document.documentElement.setAttribute('data-md-color-scheme', scheme);

          var paletteInput = document.querySelector(
            'input[data-md-color-scheme][value="' + scheme + '"]'
          );
          if (paletteInput && !paletteInput.checked) {
            paletteInput.checked = true;
          }
        }

        // 2) Двусторонняя связь: при переключении темы в MkDocs обновляем localStorage.theme
        document.addEventListener('DOMContentLoaded', function () {
          var inputs = document.querySelectorAll('input[data-md-color-scheme]');
          inputs.forEach(function (input) {
            input.addEventListener('change', function () {
              var scheme = this.value;         // 'default' или 'slate'
              var theme = scheme === 'slate' ? 'dark' : 'light';
              localStorage.setItem('theme', theme);
            });
          });
        });
      } catch (e) {
        console.warn('Theme sync failed', e);
      }
    })();
  </script>
{% endblock %}

